<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Detail Search | FMRS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/lucide-static@0.321.0/font/lucide.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/players-detail-search.css}">
    <script th:src="@{/js/players-detail-search.js}"></script>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col text-sm">

<!-- Header -->
<header class="bg-white shadow-sm">
    <nav class="w-full max-w-7xl mx-auto px-2 py-2">
        <a href="/home" class="text-lg font-bold text-slate-800 flex items-center gap-1">
            <i class="icon icon-soccer-ball text-blue-600"></i>
            FMRS
        </a>
    </nav>
</header>

<!-- Hero Section -->
<section class="hero-gradient text-white py-6">
    <div class="w-full max-w-7xl mx-auto px-2">
        <h1 class="text-2xl font-bold mb-2">Advanced Player Search</h1>
        <p class="text-base text-slate-300">Find players with specific attributes and characteristics</p>
    </div>
</section>

<!-- Main Content -->
<main class="flex-grow w-full max-w-7xl mx-auto px-2 py-4">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
        <!-- Search Form Column -->
        <div class="lg:col-span-1">
            <div class="bg-white rounded-lg shadow-sm overflow-hidden sticky top-4">
                <!-- Changed form method from post to get -->
                <form id="searchForm" method="get" th:action="@{/players/detail-search}" th:object="${searchPlayerCondition}" class="p-4" onsubmit="document.getElementById('pageField').value='0';">
                    <!-- Add this right after the opening <form> tag -->

                    <!-- Basic Information Section -->
                    <div id="section-0" class="form-section mb-4">
                        <div class="section-header flex items-center justify-between bg-blue-50 p-2 rounded-lg cursor-pointer" onclick="toggleSection('section-0')">
                            <h2 class="text-sm font-semibold text-blue-800 flex items-center">
                                <i class="icon icon-user mr-2"></i>
                                Basic Information
                            </h2>
                            <i class="icon icon-chevron-down toggle-icon text-blue-600"></i>
                        </div>
                        <div class="section-content mt-2 p-2">
                            <div class="space-y-3">
                                <!-- 폼 필드 부분을 SearchPlayerCondition 클래스 구조에 맞게 수정합니다 -->

                                <!-- Basic Information Section의 age.min, age.max 필드를 ageMin, ageMax로 변경 -->
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label for="ageMin" class="block text-xs font-medium text-gray-700 mb-1">Min Age</label>
                                        <select id="ageMin" name="ageMin" class="w-full px-2 py-1 text-xs border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option th:each="age : ${#numbers.sequence(15, 50)}"
                                                    th:value="${age}"
                                                    th:text="${age}"
                                                    th:selected="${searchPlayerCondition != null && searchPlayerCondition.ageMin != null ? searchPlayerCondition.ageMin == age : age == 15}">15</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label for="ageMax" class="block text-xs font-medium text-gray-700 mb-1">Max Age</label>
                                        <select id="ageMax" name="ageMax" class="w-full px-2 py-1 text-xs border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option th:each="age : ${#numbers.sequence(15, 50)}"
                                                    th:value="${age}"
                                                    th:text="${age}"
                                                    th:selected="${searchPlayerCondition != null && searchPlayerCondition.ageMax != null ? searchPlayerCondition.ageMax == age : age == 50}">50</option>
                                        </select>
                                    </div>
                                </div>

                                <div>
                                    <label for="nationName" class="block text-xs font-medium text-gray-700 mb-1">Nation Name</label>
                                    <input type="text" id="nationName" name="nationName" th:value="${searchPlayerCondition != null ? searchPlayerCondition.nationName : ''}" class="w-full px-2 py-1 text-xs border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>


                            </div>
                        </div>
                    </div>

                    <!-- Technical Attributes Section -->
                    <div id="section-1" class="form-section mb-4 collapsed">
                        <div class="section-header flex items-center justify-between bg-green-50 p-2 rounded-lg cursor-pointer" onclick="toggleSection('section-1')">
                            <h2 class="text-sm font-semibold text-green-800 flex items-center">
                                <i class="icon icon-zap mr-2"></i>
                                Technical Attributes
                            </h2>
                            <i class="icon icon-chevron-down toggle-icon text-green-600"></i>
                        </div>
                        <!-- Technical Attributes Section의 필드 경로 수정 -->
                        <div class="section-content mt-2 p-2">
                            <div class="grid grid-cols-2 gap-2">
                                <div th:replace=":: attributeInput('Corners', 'corners', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Crossing', 'crossing', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Dribbling', 'dribbling', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Finishing', 'finishing', 1, 20)"></div>
                                <div th:replace=":: attributeInput('First Touch', 'firstTouch', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Free Kicks', 'freeKickTaking', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Heading', 'heading', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Long Shots', 'longShots', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Long Throws', 'longThrows', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Marking', 'marking', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Passing', 'passing', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Penalties', 'penaltyTaking', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Tackling', 'tackling', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Technique', 'technique', 1, 20)"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Mental Attributes Section -->
                    <div id="section-2" class="form-section mb-4 collapsed">
                        <div class="section-header flex items-center justify-between bg-yellow-50 p-2 rounded-lg cursor-pointer" onclick="toggleSection('section-2')">
                            <h2 class="text-sm font-semibold text-yellow-800 flex items-center">
                                <i class="icon icon-brain mr-2"></i>
                                Mental Attributes
                            </h2>
                            <i class="icon icon-chevron-down toggle-icon text-yellow-600"></i>
                        </div>
                        <!-- Mental Attributes Section의 필드 경로 수정 -->
                        <div class="section-content mt-2 p-2">
                            <div class="grid grid-cols-2 gap-2">
                                <div th:replace=":: attributeInput('Aggression', 'aggression', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Anticipation', 'anticipation', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Bravery', 'bravery', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Composure', 'composure', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Concentration', 'concentration', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Decisions', 'decisions', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Determination', 'determination', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Flair', 'flair', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Leadership', 'leadership', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Off The Ball', 'offTheBall', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Positioning', 'positioning', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Teamwork', 'teamwork', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Vision', 'vision', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Work Rate', 'workRate', 1, 20)"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Physical Attributes Section -->
                    <div id="section-3" class="form-section mb-4 collapsed">
                        <div class="section-header flex items-center justify-between bg-red-50 p-2 rounded-lg cursor-pointer" onclick="toggleSection('section-3')">
                            <h2 class="text-sm font-semibold text-red-800 flex items-center">
                                <i class="icon icon-dumbbell mr-2"></i>
                                Physical Attributes
                            </h2>
                            <i class="icon icon-chevron-down toggle-icon text-red-600"></i>
                        </div>
                        <!-- Physical Attributes Section의 필드 경로 수정 -->
                        <div class="section-content mt-2 p-2">
                            <div class="grid grid-cols-2 gap-2">
                                <div th:replace=":: attributeInput('Acceleration', 'acceleration', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Agility', 'agility', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Balance', 'balance', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Jumping', 'jumpingReach', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Fitness', 'naturalFitness', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Pace', 'pace', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Stamina', 'stamina', 1, 20)"></div>
                                <div th:replace=":: attributeInput('Strength', 'strength', 1, 20)"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Position Attributes Section -->
                    <div id="section-4" class="form-section mb-4 collapsed">
                        <div class="section-header flex items-center justify-between bg-purple-50 p-2 rounded-lg cursor-pointer" onclick="toggleSection('section-4')">
                            <h2 class="text-sm font-semibold text-purple-800 flex items-center">
                                <i class="icon icon-layout mr-2"></i>
                                Position Ratings
                            </h2>
                            <i class="icon icon-chevron-down toggle-icon text-purple-600"></i>
                        </div>
                        <div class="section-content mt-2 p-2">
                            <!-- Interactive Position Map -->
                            <div class="mb-4">
                                <h3 class="text-xs font-medium text-gray-700 mb-2">Click on positions to set minimum rating to 10:</h3>
                                <div class="flex justify-center items-center">
                                    <div id="positionMap" class="position-map-container bg-black rounded-md relative overflow-hidden" style="width: 100%; max-width: 400px; aspect-ratio: 2/1;">
                                        <!-- Field markings - subtle lines -->
                                        <!-- Center line -->
                                        <div class="absolute w-px h-full left-1/2 bg-gray-700"></div>

                                        <!-- Penalty areas -->
                                        <div class="absolute w-[20%] h-[60%] border border-gray-700 left-0 top-[20%]"></div>
                                        <div class="absolute w-[20%] h-[60%] border border-gray-700 right-0 top-[20%]"></div>

                                        <!-- Goal areas -->
                                        <div class="absolute w-[10%] h-[40%] border border-gray-700 left-0 top-[30%]"></div>
                                        <div class="absolute w-[10%] h-[40%] border border-gray-700 right-0 top-[30%]"></div>

                                        <!-- Center circle -->
                                        <div class="absolute w-[20%] h-[30%] border border-gray-700 rounded-full left-[40%] top-[35%]"></div>

                                        <!-- Clickable Position Dots -->
                                        <!-- Goalkeeper (GK) -->
                                        <div class="position-clickable" data-position="GK" style="left: 5%; top: 50%;" onclick="togglePosition('GK')">
                                            <span class="position-label">GK</span>
                                        </div>

                                        <!-- Row 1: DL, WL, ML, AL -->
                                        <div class="position-clickable" data-position="LB" style="left: 25%; top: 25%;" onclick="togglePosition('LB')">
                                            <span class="position-label">LB</span>
                                        </div>
                                        <div class="position-clickable" data-position="LWB" style="left: 40%; top: 25%;" onclick="togglePosition('LWB')">
                                            <span class="position-label">LWB</span>
                                        </div>
                                        <div class="position-clickable" data-position="LM" style="left: 55%; top: 25%;" onclick="togglePosition('LM')">
                                            <span class="position-label">LM</span>
                                        </div>
                                        <div class="position-clickable" data-position="LAM" style="left: 70%; top: 25%;" onclick="togglePosition('LAM')">
                                            <span class="position-label">LAM</span>
                                        </div>

                                        <!-- Row 2: CB, DM, CM, CAM, ST -->
                                        <div class="position-clickable" data-position="CB" style="left: 25%; top: 50%;" onclick="togglePosition('CB')">
                                            <span class="position-label">CB</span>
                                        </div>
                                        <div class="position-clickable" data-position="DM" style="left: 40%; top: 50%;" onclick="togglePosition('DM')">
                                            <span class="position-label">DM</span>
                                        </div>
                                        <div class="position-clickable" data-position="CM" style="left: 55%; top: 50%;" onclick="togglePosition('CM')">
                                            <span class="position-label">CM</span>
                                        </div>
                                        <div class="position-clickable" data-position="CAM" style="left: 70%; top: 50%;" onclick="togglePosition('CAM')">
                                            <span class="position-label">CAM</span>
                                        </div>
                                        <div class="position-clickable" data-position="ST" style="left: 85%; top: 50%;" onclick="togglePosition('ST')">
                                            <span class="position-label">ST</span>
                                        </div>

                                        <!-- Row 3: RB, RWB, RM, RAM -->
                                        <div class="position-clickable" data-position="RB" style="left: 25%; top: 75%;" onclick="togglePosition('RB')">
                                            <span class="position-label">RB</span>
                                        </div>
                                        <div class="position-clickable" data-position="RWB" style="left: 40%; top: 75%;" onclick="togglePosition('RWB')">
                                            <span class="position-label">RWB</span>
                                        </div>
                                        <div class="position-clickable" data-position="RM" style="left: 55%; top: 75%;" onclick="togglePosition('RM')">
                                            <span class="position-label">RM</span>
                                        </div>
                                        <div class="position-clickable" data-position="RAM" style="left: 70%; top: 75%;" onclick="togglePosition('RAM')">
                                            <span class="position-label">RAM</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 text-center text-xs text-slate-500">
                                    <span class="inline-block px-1 mx-1">
                                        <span class="inline-block w-2 h-2 bg-gray-500 rounded-sm mr-1"></span> Default
                                    </span>
                                    <span class="inline-block px-1 mx-1">
                                        <span class="inline-block w-2 h-2 bg-emerald-500 rounded-sm mr-1"></span> Selected (Min 10)
                                    </span>
                                </div>
                            </div>

                            <!-- Hidden Position Input Fields (for form submission) -->
                            <div style="display: none;">
                                <input type="number" id="GK" name="GK" value="">
                                <input type="number" id="LB" name="LB" value="">
                                <input type="number" id="CB" name="CB" value="">
                                <input type="number" id="RB" name="RB" value="">
                                <input type="number" id="LWB" name="LWB" value="">
                                <input type="number" id="RWB" name="RWB" value="">
                                <input type="number" id="DM" name="DM" value="">
                                <input type="number" id="LM" name="LM" value="">
                                <input type="number" id="CM" name="CM" value="">
                                <input type="number" id="RM" name="RM" value="">
                                <input type="number" id="LAM" name="LAM" value="">
                                <input type="number" id="CAM" name="CAM" value="">
                                <input type="number" id="RAM" name="RAM" value="">
                                <input type="number" id="ST" name="ST" value="">
                            </div>
                        </div>
                    </div>



                    <!-- Submit Buttons -->
                    <div class="flex justify-between mt-4">
                        <button type="button" onclick="resetForm(); return false;" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition text-xs">
                            Reset
                        </button>
                        <button type="submit" class="px-4 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition flex items-center text-xs">
                            <i class="icon icon-search mr-1"></i>
                            Search
                        </button>
                    </div>

                    <!-- Hidden fields for sorting and pagination -->
                    <input type="hidden" id="sortField" name="sort" th:value="${param.sort != null ? param.sort[0] : ''}">
                    <input type="hidden" id="pageField" name="page" th:value="${currentPage != null ? currentPage : 0}">
                    <input type="hidden" name="size" th:value="${pageSize != null ? pageSize : 10}">
                </form>
            </div>
        </div>

        <!-- Search Results Column -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                <div class="p-4">
                    <h2 class="text-lg font-semibold mb-4 text-slate-800">Search Results</h2>

                    <!-- Results Count and Sort Options -->
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-sm text-slate-600">
                            <span th:text="${totalElements != null ? totalElements : (players != null && players.totalElements != null ? players.totalElements : 0)}">0</span> players found
                            <span th:if="${totalPages != null && totalPages > 0}" class="ml-1">
                                (Page <span th:text="${currentPage != null ? currentPage + 1 : 1}">1</span> of <span th:text="${totalPages}">1</span>)
                            </span>
                        </div>
                        <div class="flex items-center gap-2">
                            <label for="sortBy" class="text-xs text-slate-600">Sort by:</label>
                            <select id="sortBy" class="text-xs border border-gray-300 rounded-md px-2 py-1" onchange="updateSort(this.value)">
                                <option value="name" th:selected="${param.sort != null && param.sort[0] == 'name'}">Name</option>
                                <option value="age" th:selected="${param.sort != null && param.sort[0] == 'age'}">Age</option>
                                <option value="currentAbility" th:selected="${param.sort != null && param.sort[0] == 'currentAbility'}">Current Ability</option>
                                <option value="teamName" th:selected="${param.sort != null && param.sort[0] == 'teamName'}">Team</option>
                                <option value="nationName" th:selected="${param.sort != null && param.sort[0] == 'nationName'}">Nation</option>
                            </select>
                        </div>
                    </div>

                    <!-- No Results Message -->
                    <div th:if="${players == null || players.players == null || players.players.isEmpty()}"
                         class="p-8 bg-gray-50 rounded-lg text-center">
                        <i class="icon icon-search-x text-gray-400 text-4xl mb-2"></i>
                        <h3 class="text-lg font-semibold text-gray-700 mb-1">No Players Found</h3>
                        <p class="text-gray-500">Try adjusting your search criteria to find more players.</p>
                    </div>

                    <!-- Results Grid -->
                    <div th:if="${players != null && players.players != null && !players.players.isEmpty()}"
                         class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <!-- Player Cards -->
                        <div th:each="player : ${players.players}"
                             class="border border-gray-100 rounded-lg overflow-hidden hover:shadow-md transition duration-300">
                            <div class="p-3">
                                <div class="flex items-start gap-3">
                                    <div class="relative group">
                                        <div class="w-14 h-14 rounded-lg overflow-hidden bg-slate-200 border border-slate-300 shadow-sm transition-transform duration-300 transform group-hover:scale-105">
                                            <img th:src="${player.imageUrl}" th:alt="${player.name}" class="w-full h-full object-cover">
                                        </div>
                                    </div>
                                    <div class="flex-grow">
                                        <h3 class="text-sm font-semibold mb-0.5">
                                            <a th:href="@{/players/{id}(id=${player.id})}" class="text-slate-800 hover:text-blue-600 transition duration-300" th:text="${player.name}">Player Name</a>
                                        </h3>
                                        <div class="flex flex-col text-xs">
                                            <div class="flex items-center">
                                                <img th:if="${player.teamLogoUrl != null}" th:src="${player.teamLogoUrl}" alt="Team logo" class="w-4 h-4 mr-1">
                                                <span class="text-slate-600" th:text="${player.teamName}">Team Name</span>
                                            </div>
                                            <span class="text-slate-600" th:if="${player.isGK}">Goalkeeper</span>
                                            <div class="flex items-center gap-1 mt-1">
                                                <span class="px-1.5 py-0.5 bg-blue-100 rounded-full text-xs text-blue-800" th:text="${'Age: ' + player.age}">Age: 25</span>
                                                <span class="px-1.5 py-0.5 bg-green-100 rounded-full text-xs text-green-800" th:if="${player.currentAbility != null}" th:text="${'CA: ' + player.currentAbility}">CA: 150</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="flex flex-col items-end">
                                            <span class="text-xs text-slate-600" th:text="${player.nationName}">Nation</span>
                                            <div class="mt-1 flex items-center">
                                                <img th:if="${player.nationLogoUrl != null}" th:src="${player.nationLogoUrl}" alt="Nation flag" class="w-4 h-4">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-50 px-3 py-1.5 flex justify-between items-center">
                                <div class="text-xs">
                                    <span class="text-slate-600" th:text="${'H: ' + player.height + 'cm'}">H: 180cm</span>
                                    <span class="text-slate-600 ml-2" th:text="${'W: ' + player.weight + 'kg'}">W: 75kg</span>
                                </div>
                                <a th:href="@{/players/{id}(id=${player.id})}" class="text-xs text-blue-600 hover:text-blue-700 transition duration-300 flex items-center">
                                    View Profile
                                    <i class="icon icon-arrow-right ml-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Pagination - Reverted to direct URLs with all parameters -->
                    <div th:if="${players != null && players.players != null && !players.players.isEmpty() && (totalPages != null && totalPages > 1)}"
                         class="mt-6 flex justify-center"
                         style="overflow-x: auto; padding: 1rem 0;">
                        <nav class="inline-flex rounded-md shadow-sm" aria-label="Pagination">
                            <!-- Previous Page -->
                            <a th:with="prevPage=${currentPage > 0 ? currentPage - 1 : 0}"
                               th:href="@{/players/detail-search(page=${prevPage}, size=${pageSize}, ageMin=${searchPlayerCondition.ageMin}, ageMax=${searchPlayerCondition.ageMax}, nationName=${searchPlayerCondition.nationName}, dribbling=${searchPlayerCondition.dribbling}, corners=${searchPlayerCondition.corners}, crossing=${searchPlayerCondition.crossing}, finishing=${searchPlayerCondition.finishing}, firstTouch=${searchPlayerCondition.firstTouch}, freeKickTaking=${searchPlayerCondition.freeKickTaking}, heading=${searchPlayerCondition.heading}, longShots=${searchPlayerCondition.longShots}, longThrows=${searchPlayerCondition.longThrows}, marking=${searchPlayerCondition.marking}, passing=${searchPlayerCondition.passing}, penaltyTaking=${searchPlayerCondition.penaltyTaking}, tackling=${searchPlayerCondition.tackling}, technique=${searchPlayerCondition.technique}, aggression=${searchPlayerCondition.aggression}, anticipation=${searchPlayerCondition.anticipation}, bravery=${searchPlayerCondition.bravery}, composure=${searchPlayerCondition.composure}, concentration=${searchPlayerCondition.concentration}, decisions=${searchPlayerCondition.decisions}, determination=${searchPlayerCondition.determination}, flair=${searchPlayerCondition.flair}, leadership=${searchPlayerCondition.leadership}, offTheBall=${searchPlayerCondition.offTheBall}, positioning=${searchPlayerCondition.positioning}, teamwork=${searchPlayerCondition.teamwork}, vision=${searchPlayerCondition.vision}, workRate=${searchPlayerCondition.workRate}, acceleration=${searchPlayerCondition.acceleration}, agility=${searchPlayerCondition.agility}, balance=${searchPlayerCondition.balance}, jumpingReach=${searchPlayerCondition.jumpingReach}, naturalFitness=${searchPlayerCondition.naturalFitness}, pace=${searchPlayerCondition.pace}, stamina=${searchPlayerCondition.stamina}, strength=${searchPlayerCondition.strength}, GK=${searchPlayerCondition.GK}, LB=${searchPlayerCondition.LB}, CB=${searchPlayerCondition.CB}, RB=${searchPlayerCondition.RB}, LWB=${searchPlayerCondition.LWB}, RWB=${searchPlayerCondition.RWB}, DM=${searchPlayerCondition.DM}, LM=${searchPlayerCondition.LM}, CM=${searchPlayerCondition.CM}, RM=${searchPlayerCondition.RM}, LAM=${searchPlayerCondition.LAM}, CAM=${searchPlayerCondition.CAM}, RAM=${searchPlayerCondition.RAM}, ST=${searchPlayerCondition.ST}, sort=${param.sort != null ? param.sort[0] : ''})}"
                               th:class="${currentPage > 0 ? 'cursor-pointer hover:bg-gray-50' : 'cursor-not-allowed bg-gray-100'}"
                               class="relative inline-flex items-center px-3 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 pagination-link">
                                <span class="sr-only">Previous</span>
                                <i class="icon icon-chevron-left"></i>
                            </a>

                            <!-- Page Numbers -->
                            <th:block th:if="${totalPages <= 7}">
                                <th:block th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                                    <a th:href="@{/players/detail-search(page=${i}, size=${pageSize}, ageMin=${searchPlayerCondition.ageMin}, ageMax=${searchPlayerCondition.ageMax}, nationName=${searchPlayerCondition.nationName}, dribbling=${searchPlayerCondition.dribbling}, corners=${searchPlayerCondition.corners}, crossing=${searchPlayerCondition.crossing}, finishing=${searchPlayerCondition.finishing}, firstTouch=${searchPlayerCondition.firstTouch}, freeKickTaking=${searchPlayerCondition.freeKickTaking}, heading=${searchPlayerCondition.heading}, longShots=${searchPlayerCondition.longShots}, longThrows=${searchPlayerCondition.longThrows}, marking=${searchPlayerCondition.marking}, passing=${searchPlayerCondition.passing}, penaltyTaking=${searchPlayerCondition.penaltyTaking}, tackling=${searchPlayerCondition.tackling}, technique=${searchPlayerCondition.technique}, aggression=${searchPlayerCondition.aggression}, anticipation=${searchPlayerCondition.anticipation}, bravery=${searchPlayerCondition.bravery}, composure=${searchPlayerCondition.composure}, concentration=${searchPlayerCondition.concentration}, decisions=${searchPlayerCondition.decisions}, determination=${searchPlayerCondition.determination}, flair=${searchPlayerCondition.flair}, leadership=${searchPlayerCondition.leadership}, offTheBall=${searchPlayerCondition.offTheBall}, positioning=${searchPlayerCondition.positioning}, teamwork=${searchPlayerCondition.teamwork}, vision=${searchPlayerCondition.vision}, workRate=${searchPlayerCondition.workRate}, acceleration=${searchPlayerCondition.acceleration}, agility=${searchPlayerCondition.agility}, balance=${searchPlayerCondition.balance}, jumpingReach=${searchPlayerCondition.jumpingReach}, naturalFitness=${searchPlayerCondition.naturalFitness}, pace=${searchPlayerCondition.pace}, stamina=${searchPlayerCondition.stamina}, strength=${searchPlayerCondition.strength}, GK=${searchPlayerCondition.GK}, LB=${searchPlayerCondition.LB}, CB=${searchPlayerCondition.CB}, RB=${searchPlayerCondition.RB}, LWB=${searchPlayerCondition.LWB}, RWB=${searchPlayerCondition.RWB}, DM=${searchPlayerCondition.DM}, LM=${searchPlayerCondition.LM}, CM=${searchPlayerCondition.CM}, RM=${searchPlayerCondition.RM}, LAM=${searchPlayerCondition.LAM}, CAM=${searchPlayerCondition.CAM}, RAM=${searchPlayerCondition.RAM}, ST=${searchPlayerCondition.ST}, sort=${param.sort != null ? param.sort[0] : ''})}"
                                       th:class="${i == currentPage ? 'bg-blue-50 text-blue-600' : 'bg-white text-gray-500 hover:bg-gray-50'}"
                                       class="relative inline-flex items-center border border-gray-300 text-sm font-medium pagination-link"
                                       style="padding-left: 1.5rem; padding-right: 1.5rem; margin: 0 0.5rem;"
                                       th:text="${i + 1}">1</a>
                                </th:block>
                            </th:block>

                            <!-- Truncated Page Numbers for many pages -->
                            <th:block th:if="${totalPages > 7}">
                                <!-- First page -->
                                <a th:href="@{/players/detail-search(page=0, size=${pageSize}, ageMin=${searchPlayerCondition.ageMin}, ageMax=${searchPlayerCondition.ageMax}, nationName=${searchPlayerCondition.nationName}, dribbling=${searchPlayerCondition.dribbling}, corners=${searchPlayerCondition.corners}, crossing=${searchPlayerCondition.crossing}, finishing=${searchPlayerCondition.finishing}, firstTouch=${searchPlayerCondition.firstTouch}, freeKickTaking=${searchPlayerCondition.freeKickTaking}, heading=${searchPlayerCondition.heading}, longShots=${searchPlayerCondition.longShots}, longThrows=${searchPlayerCondition.longThrows}, marking=${searchPlayerCondition.marking}, passing=${searchPlayerCondition.passing}, penaltyTaking=${searchPlayerCondition.penaltyTaking}, tackling=${searchPlayerCondition.tackling}, technique=${searchPlayerCondition.technique}, aggression=${searchPlayerCondition.aggression}, anticipation=${searchPlayerCondition.anticipation}, bravery=${searchPlayerCondition.bravery}, composure=${searchPlayerCondition.composure}, concentration=${searchPlayerCondition.concentration}, decisions=${searchPlayerCondition.decisions}, determination=${searchPlayerCondition.determination}, flair=${searchPlayerCondition.flair}, leadership=${searchPlayerCondition.leadership}, offTheBall=${searchPlayerCondition.offTheBall}, positioning=${searchPlayerCondition.positioning}, teamwork=${searchPlayerCondition.teamwork}, vision=${searchPlayerCondition.vision}, workRate=${searchPlayerCondition.workRate}, acceleration=${searchPlayerCondition.acceleration}, agility=${searchPlayerCondition.agility}, balance=${searchPlayerCondition.balance}, jumpingReach=${searchPlayerCondition.jumpingReach}, naturalFitness=${searchPlayerCondition.naturalFitness}, pace=${searchPlayerCondition.pace}, stamina=${searchPlayerCondition.stamina}, strength=${searchPlayerCondition.strength}, GK=${searchPlayerCondition.GK}, LB=${searchPlayerCondition.LB}, CB=${searchPlayerCondition.CB}, RB=${searchPlayerCondition.RB}, LWB=${searchPlayerCondition.LWB}, RWB=${searchPlayerCondition.RWB}, DM=${searchPlayerCondition.DM}, LM=${searchPlayerCondition.LM}, CM=${searchPlayerCondition.CM}, RM=${searchPlayerCondition.RM}, LAM=${searchPlayerCondition.LAM}, CAM=${searchPlayerCondition.CAM}, RAM=${searchPlayerCondition.RAM}, ST=${searchPlayerCondition.ST}, sort=${param.sort != null ? param.sort[0] : ''})}"
                                   th:class="${0 == currentPage ? 'bg-blue-50 text-blue-600' : 'bg-white text-gray-500 hover:bg-gray-50'}"
                                   class="relative inline-flex items-center border border-gray-300 text-sm font-medium pagination-link"
                                   style="padding-left: 1.5rem; padding-right: 1.5rem; margin: 0 0.5rem;"
                                   th:text="1">1</a>

                                <!-- Ellipsis if current page is far from start -->
                                <span th:if="${currentPage > 3}" class="relative inline-flex items-center border border-gray-300 bg-white text-sm font-medium text-gray-700 pagination-link" style="padding-left: 1.5rem; padding-right: 1.5rem; margin: 0 0.5rem;">⋯</span>

                                <!-- Pages around current page -->
                                <th:block th:each="i : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 1, currentPage < totalPages - 3 ? currentPage + 2 : totalPages - 2)}">
                                    <a th:if="${i > 0 && i < totalPages - 1}"
                                       th:href="@{/players/detail-search(page=${i}, size=${pageSize}, ageMin=${searchPlayerCondition.ageMin}, ageMax=${searchPlayerCondition.ageMax}, nationName=${searchPlayerCondition.nationName}, dribbling=${searchPlayerCondition.dribbling}, corners=${searchPlayerCondition.corners}, crossing=${searchPlayerCondition.crossing}, finishing=${searchPlayerCondition.finishing}, firstTouch=${searchPlayerCondition.firstTouch}, freeKickTaking=${searchPlayerCondition.freeKickTaking}, heading=${searchPlayerCondition.heading}, longShots=${searchPlayerCondition.longShots}, longThrows=${searchPlayerCondition.longThrows}, marking=${searchPlayerCondition.marking}, passing=${searchPlayerCondition.passing}, penaltyTaking=${searchPlayerCondition.penaltyTaking}, tackling=${searchPlayerCondition.tackling}, technique=${searchPlayerCondition.technique}, aggression=${searchPlayerCondition.aggression}, anticipation=${searchPlayerCondition.anticipation}, bravery=${searchPlayerCondition.bravery}, composure=${searchPlayerCondition.composure}, concentration=${searchPlayerCondition.concentration}, decisions=${searchPlayerCondition.decisions}, determination=${searchPlayerCondition.determination}, flair=${searchPlayerCondition.flair}, leadership=${searchPlayerCondition.leadership}, offTheBall=${searchPlayerCondition.offTheBall}, positioning=${searchPlayerCondition.positioning}, teamwork=${searchPlayerCondition.teamwork}, vision=${searchPlayerCondition.vision}, workRate=${searchPlayerCondition.workRate}, acceleration=${searchPlayerCondition.acceleration}, agility=${searchPlayerCondition.agility}, balance=${searchPlayerCondition.balance}, jumpingReach=${searchPlayerCondition.jumpingReach}, naturalFitness=${searchPlayerCondition.naturalFitness}, pace=${searchPlayerCondition.pace}, stamina=${searchPlayerCondition.stamina}, strength=${searchPlayerCondition.strength}, GK=${searchPlayerCondition.GK}, LB=${searchPlayerCondition.LB}, CB=${searchPlayerCondition.CB}, RB=${searchPlayerCondition.RB}, LWB=${searchPlayerCondition.LWB}, RWB=${searchPlayerCondition.RWB}, DM=${searchPlayerCondition.DM}, LM=${searchPlayerCondition.LM}, CM=${searchPlayerCondition.CM}, RM=${searchPlayerCondition.RM}, LAM=${searchPlayerCondition.LAM}, CAM=${searchPlayerCondition.CAM}, RAM=${searchPlayerCondition.RAM}, ST=${searchPlayerCondition.ST}, sort=${param.sort != null ? param.sort[0] : ''})}"
                                       th:class="${i == currentPage ? 'bg-blue-50 text-blue-600' : 'bg-white text-gray-500 hover:bg-gray-50'}"
                                       class="relative inline-flex items-center border border-gray-300 text-sm font-medium pagination-link"
                                       style="padding-left: 1.5rem; padding-right: 1.5rem; margin: 0 0.5rem;"
                                       th:text="${i + 1}">1</a>
                                </th:block>

                                <!-- Ellipsis if current page is far from end -->
                                <span th:if="${currentPage < totalPages - 4}" class="relative inline-flex items-center border border-gray-300 bg-white text-sm font-medium text-gray-700 pagination-link" style="padding-left: 1.5rem; padding-right: 1.5rem; margin: 0 0.5rem;">⋯</span>

                                <!-- Last page -->
                                <a th:href="@{/players/detail-search(page=${totalPages - 1}, size=${pageSize}, ageMin=${searchPlayerCondition.ageMin}, ageMax=${searchPlayerCondition.ageMax}, nationName=${searchPlayerCondition.nationName}, dribbling=${searchPlayerCondition.dribbling}, corners=${searchPlayerCondition.corners}, crossing=${searchPlayerCondition.crossing}, finishing=${searchPlayerCondition.finishing}, firstTouch=${searchPlayerCondition.firstTouch}, freeKickTaking=${searchPlayerCondition.freeKickTaking}, heading=${searchPlayerCondition.heading}, longShots=${searchPlayerCondition.longShots}, longThrows=${searchPlayerCondition.longThrows}, marking=${searchPlayerCondition.marking}, passing=${searchPlayerCondition.passing}, penaltyTaking=${searchPlayerCondition.penaltyTaking}, tackling=${searchPlayerCondition.tackling}, technique=${searchPlayerCondition.technique}, aggression=${searchPlayerCondition.aggression}, anticipation=${searchPlayerCondition.anticipation}, bravery=${searchPlayerCondition.bravery}, composure=${searchPlayerCondition.composure}, concentration=${searchPlayerCondition.concentration}, decisions=${searchPlayerCondition.decisions}, determination=${searchPlayerCondition.determination}, flair=${searchPlayerCondition.flair}, leadership=${searchPlayerCondition.leadership}, offTheBall=${searchPlayerCondition.offTheBall}, positioning=${searchPlayerCondition.positioning}, teamwork=${searchPlayerCondition.teamwork}, vision=${searchPlayerCondition.vision}, workRate=${searchPlayerCondition.workRate}, acceleration=${searchPlayerCondition.acceleration}, agility=${searchPlayerCondition.agility}, balance=${searchPlayerCondition.balance}, jumpingReach=${searchPlayerCondition.jumpingReach}, naturalFitness=${searchPlayerCondition.naturalFitness}, pace=${searchPlayerCondition.pace}, stamina=${searchPlayerCondition.stamina}, strength=${searchPlayerCondition.strength}, GK=${searchPlayerCondition.GK}, LB=${searchPlayerCondition.LB}, CB=${searchPlayerCondition.CB}, RB=${searchPlayerCondition.RB}, LWB=${searchPlayerCondition.LWB}, RWB=${searchPlayerCondition.RWB}, DM=${searchPlayerCondition.DM}, LM=${searchPlayerCondition.LM}, CM=${searchPlayerCondition.CM}, RM=${searchPlayerCondition.RM}, LAM=${searchPlayerCondition.LAM}, CAM=${searchPlayerCondition.CAM}, RAM=${searchPlayerCondition.RAM}, ST=${searchPlayerCondition.ST}, sort=${param.sort != null ? param.sort[0] : ''})}"
                                   th:class="${totalPages - 1 == currentPage ? 'bg-blue-50 text-blue-600' : 'bg-white text-gray-500 hover:bg-gray-50'}"
                                   class="relative inline-flex items-center border border-gray-300 text-sm font-medium pagination-link"
                                   style="padding-left: 1.5rem; padding-right: 1.5rem; margin: 0 0.5rem;"
                                   th:text="${totalPages}">10</a>
                            </th:block>

                            <!-- Next Page -->
                            <a th:with="nextPage=${currentPage < totalPages - 1 ? currentPage + 1 : totalPages - 1}"
                               th:href="@{/players/detail-search(page=${nextPage}, size=${pageSize}, ageMin=${searchPlayerCondition.ageMin}, ageMax=${searchPlayerCondition.ageMax}, nationName=${searchPlayerCondition.nationName}, dribbling=${searchPlayerCondition.dribbling}, corners=${searchPlayerCondition.corners}, crossing=${searchPlayerCondition.crossing}, finishing=${searchPlayerCondition.finishing}, firstTouch=${searchPlayerCondition.firstTouch}, freeKickTaking=${searchPlayerCondition.freeKickTaking}, heading=${searchPlayerCondition.heading}, longShots=${searchPlayerCondition.longShots}, longThrows=${searchPlayerCondition.longThrows}, marking=${searchPlayerCondition.marking}, passing=${searchPlayerCondition.passing}, penaltyTaking=${searchPlayerCondition.penaltyTaking}, tackling=${searchPlayerCondition.tackling}, technique=${searchPlayerCondition.technique}, aggression=${searchPlayerCondition.aggression}, anticipation=${searchPlayerCondition.anticipation}, bravery=${searchPlayerCondition.bravery}, composure=${searchPlayerCondition.composure}, concentration=${searchPlayerCondition.concentration}, decisions=${searchPlayerCondition.decisions}, determination=${searchPlayerCondition.determination}, flair=${searchPlayerCondition.flair}, leadership=${searchPlayerCondition.leadership}, offTheBall=${searchPlayerCondition.offTheBall}, positioning=${searchPlayerCondition.positioning}, teamwork=${searchPlayerCondition.teamwork}, vision=${searchPlayerCondition.vision}, workRate=${searchPlayerCondition.workRate}, acceleration=${searchPlayerCondition.acceleration}, agility=${searchPlayerCondition.agility}, balance=${searchPlayerCondition.balance}, jumpingReach=${searchPlayerCondition.jumpingReach}, naturalFitness=${searchPlayerCondition.naturalFitness}, pace=${searchPlayerCondition.pace}, stamina=${searchPlayerCondition.stamina}, strength=${searchPlayerCondition.strength}, GK=${searchPlayerCondition.GK}, LB=${searchPlayerCondition.LB}, CB=${searchPlayerCondition.CB}, RB=${searchPlayerCondition.RB}, LWB=${searchPlayerCondition.LWB}, RWB=${searchPlayerCondition.RWB}, DM=${searchPlayerCondition.DM}, LM=${searchPlayerCondition.LM}, CM=${searchPlayerCondition.CM}, RM=${searchPlayerCondition.RM}, LAM=${searchPlayerCondition.LAM}, CAM=${searchPlayerCondition.CAM}, RAM=${searchPlayerCondition.RAM}, ST=${searchPlayerCondition.ST}, sort=${param.sort != null ? param.sort[0] : ''})}"
                               th:class="${currentPage < totalPages - 1 ? 'cursor-pointer hover:bg-gray-50' : 'cursor-not-allowed bg-gray-100'}"
                               class="relative inline-flex items-center px-3 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 pagination-link">
                                <span class="sr-only">Next</span>
                                <i class="icon icon-chevron-right"></i>
                            </a>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Attribute Input Template -->
<div th:fragment="attributeInput(label, field, min, max)">
    <div>
        <label th:for="${field}" class="block text-xs font-medium text-gray-700 mb-1" th:text="${label}">Attribute</label>
        <input type="number" th:id="${field}" th:name="${field}"
               th:value="${searchPlayerCondition != null && searchPlayerCondition.__${field}__ != null ? searchPlayerCondition.__${field}__ : ''}"
               th:min="${min}" th:max="${max}"
               class="w-full px-2 py-1 text-xs border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
    </div>
</div>

</body>
</html>
